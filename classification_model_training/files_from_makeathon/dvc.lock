schema: '2.0'
stages:
  train:
    cmd: python train.py --num_classes 4 --pretrained_on_ImageNet --fold 1 --dataset
      ./data/train/images --gt ./data/train/gt.csv --outdir models --epochs 30 --seed
      1
    deps:
    - path: data/train
      hash: md5
      md5: 0263429cb9fefbc8b68b6a88c26d942f.dir
      size: 2506709
      nfiles: 362
    - path: train.py
      hash: md5
      md5: 18acedcc5c903d6a6dcfc08f4d97dc02
      size: 11045
    params:
      params.yaml:
        base:
          random_seed: 1
        train:
          fold: 1
          dataset: ./data/train/images
          gt: ./data/train/gt.csv
          num_classes: 4
          metric: f1_score
          device: cuda
          epochs: 30
          train_batch: 16
          val_batch: 16
          outdir: models
          lr: 0.001
    outs:
    - path: models/model_best.pt
      hash: md5
      md5: 43b5c6b74a5b036831c4195bf8679e90
      size: 31270857
  evaluate:
    cmd: python predict.py --num_classes 4 --dataset ./data/test/images --gt ./data/test/gt.csv
      --single_model_path models/model_best.pt --metrics_file_path models/metrics-evaluate.json
    deps:
    - path: data/test
      hash: md5
      md5: e03ff535d9f3da7f51ed642b70ec5d95.dir
      size: 549163
      nfiles: 80
    - path: models/model_best.pt
      hash: md5
      md5: 43b5c6b74a5b036831c4195bf8679e90
      size: 31270857
    - path: predict.py
      hash: md5
      md5: 8423985a8b1f20117aecc13fd9e81fa3
      size: 5868
    params:
      params.yaml:
        base:
          random_seed: 1
        evaluate:
          dataset: ./data/test/images
          gt: ./data/test/gt.csv
          device: cuda
          val_bs: 16
        train:
          fold: 1
          dataset: ./data/train/images
          gt: ./data/train/gt.csv
          num_classes: 4
          metric: f1_score
          device: cuda
          epochs: 30
          train_batch: 16
          val_batch: 16
          outdir: models
          lr: 0.001
    outs:
    - path: models/metrics-evaluate.json
      hash: md5
      md5: 49a445cb95476dbc8dc7e7e2530050f0
      size: 74
  export:
    cmd: python export.py --single_model_path models/model_best.pt --outdir models
    deps:
    - path: export.py
      hash: md5
      md5: 4584225cf8f5f59b78f82eb4f05bf2db
      size: 1403
    - path: models/model_best.pt
      hash: md5
      md5: 43b5c6b74a5b036831c4195bf8679e90
      size: 31270857
    params:
      params.yaml:
        base:
          random_seed: 1
        export:
          outdir: models
        train:
          fold: 1
          dataset: ./data/train/images
          gt: ./data/train/gt.csv
          num_classes: 4
          metric: f1_score
          device: cuda
          epochs: 30
          train_batch: 16
          val_batch: 16
          outdir: models
          lr: 0.001
    outs:
    - path: models/model_best.onnx
      hash: md5
      md5: 6fb71dcfc8ee3f457e01ae653896f508
      size: 30725959
    - path: models/model_best.pb
      hash: md5
      md5: ecd8548b017f9e2028d365b7bdbeaaad.dir
      size: 31511209
      nfiles: 3
  tensorflowjs:
    cmd: tensorflowjs_converter --input_format=tf_saved_model --output_node_names=tfjs_layers_model
      --saved_model_tags=serve models/model_best.pb models/tfjs
    deps:
    - path: models/model_best.pb
      hash: md5
      md5: ecd8548b017f9e2028d365b7bdbeaaad.dir
      size: 31511209
      nfiles: 3
    params:
      params.yaml:
        base:
          random_seed: 1
    outs:
    - path: models/tfjs
      hash: md5
      md5: d14e68ac11884407bf7fd1665fcbc8df.dir
      size: 31117801
      nfiles: 9
